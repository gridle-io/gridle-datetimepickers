{"version":3,"file":"datepicker.bundle.js","sources":["../src/datepicker/datepicker.js","../src/datepicker/index.js"],"sourcesContent":["'use strict';\n\nimport angular from 'angular';\nimport moment from 'moment';\nimport { isString } from 'lodash';\n\n/**\n * @kind function\n * @name datepicker\n *\n * @description\n * The datepicker component renders a custom datepicker. The datepicker provides\n * 3 dropdowns, one for Year, Month and Date. The datepicker also uses the NgModelController,\n * to use the parent ng-model variable and to enable form validations if used within a form.\n *\n * @param {Object} ngModel The ng-model value attached to the element.\n * @param {Object} datepickerConfig The datepicker configuration\n * @param {Date|string|moment} [datepickerConfig.max=null] The maximum date the datepicker should allow\n * @param {Date|string|moment} [datepickerConfig.max=null] The minimum date the datepicker should allow\n * @param {boolean} [datepickerConfig.max=true] Whether a strict parsing should be done or not\n * @param {boolean} [datepickerConfig.validate=false] Whether to perform validation on the value or not\n */\n\nfunction datepickerComponent() {\n\n\t/**\n\t * The directives definition\n\t */\n\treturn {\n\t\trequire: 'ngModel',\n\t\trestrict: 'AE',\n\t\tscope: {\n\t\t\tngModel: '=',\n\t\t\tconfig: '<?datepickerConfig'\n\t\t},\n\t\ttemplate: `\n\t\t<div class=\"datepicker-select\" layout=\"row\" layout-align=\"start center\">\n\t\t\t<select class=\"form-control month\" name=\"month\" ng-model=\"month\">\n\t\t\t\t<option disabled=\"\" label=\"Month\" value=\"\">Month</option>\n\t\t\t\t<option value=\"01\">January</option>\n\t\t\t\t<option value=\"02\">February</option>\n\t\t\t\t<option value=\"03\">March</option>\n\t\t\t\t<option value=\"04\">April</option>\n\t\t\t\t<option value=\"05\">May</option>\n\t\t\t\t<option value=\"06\">June</option>\n\t\t\t\t<option value=\"07\">July</option>\n\t\t\t\t<option value=\"08\">August</option>\n\t\t\t\t<option value=\"09\">September</option>\n\t\t\t\t<option value=\"10\">October</option>\n\t\t\t\t<option value=\"11\">November</option>\n\t\t\t\t<option value=\"12\">December</option>\n\t\t\t</select>\n\t\t\t<select class=\"form-control day\" name=\"day\" ng-model=\"day\">\n\t\t\t\t<option disabled=\"\" label=\"Day\" value=\"\">Day</option>\n\t\t\t\t<option value=\"01\">01</option>\n\t\t\t\t<option value=\"02\">02</option>\n\t\t\t\t<option value=\"03\">03</option>\n\t\t\t\t<option value=\"04\">04</option>\n\t\t\t\t<option value=\"05\">05</option>\n\t\t\t\t<option value=\"06\">06</option>\n\t\t\t\t<option value=\"07\">07</option>\n\t\t\t\t<option value=\"08\">08</option>\n\t\t\t\t<option value=\"09\">09</option>\n\t\t\t\t<option value=\"10\">10</option>\n\t\t\t\t<option value=\"11\">11</option>\n\t\t\t\t<option value=\"12\">12</option>\n\t\t\t\t<option value=\"13\">13</option>\n\t\t\t\t<option value=\"14\">14</option>\n\t\t\t\t<option value=\"15\">15</option>\n\t\t\t\t<option value=\"16\">16</option>\n\t\t\t\t<option value=\"17\">17</option>\n\t\t\t\t<option value=\"18\">18</option>\n\t\t\t\t<option value=\"19\">19</option>\n\t\t\t\t<option value=\"20\">20</option>\n\t\t\t\t<option value=\"21\">21</option>\n\t\t\t\t<option value=\"22\">22</option>\n\t\t\t\t<option value=\"23\">23</option>\n\t\t\t\t<option value=\"24\">24</option>\n\t\t\t\t<option value=\"25\">25</option>\n\t\t\t\t<option value=\"26\">26</option>\n\t\t\t\t<option value=\"27\">27</option>\n\t\t\t\t<option value=\"28\">28</option>\n\t\t\t\t<option value=\"29\">29</option>\n\t\t\t\t<option value=\"30\">30</option>\n\t\t\t\t<option value=\"31\">31</option>\n\t\t\t</select>\n\t\t\t<select class=\"form-control year\" ng-options=\"year as year for year in years\" name=\"year\" ng-model=\"year\">\n\t\t\t\t<option disabled=\"\" label=\"Year\" value=\"\">Year</option>\n\t\t\t</select>\n\t\t</div>`,\n\t\tlink: linkFn\n\t};\n}\n\n/**\n * The date-picker components link function\n * @function linkFn\n * @name datepickerComponent#link\n * @kind link\n */\nfunction linkFn($scope, element, attrs, NgModelController) {\n\n\t/**\n\t * The datepicker configuration object\n\t * @property {Date|string|moment} [max=null] The maximum date the datepicker should allow\n\t * @property {Date|string|moment} [min=null] The minimum date the datepicker should allow\n\t * @property {boolean} [strict=true] Whether a strict parsing should be done or not\n\t * @property {boolean} [validate=false] Whether to perform validation on the value or not\n\t * @type {Object}\n\t */\n\tlet config = {\n\t\tmax: null,\n\t\tmin: null,\n\t\tstrict: true,\n\t\tvalidate: true\n\t};\n\n\t/**\n\t * Stores a list of years\n\t * @type {number[]}\n\t */\n\t$scope.years = [];\n\n\t/**\n\t * Stores the reference to the $setDirty method of the NgModelController.\n\t * @type {NgModel.$setDirty}\n\t */\n\tlet tmp = NgModelController.$setDirty;\n\n\t// Temporarily set the $setDirty function to noop, to make sure form-validations work properly\n\tNgModelController.$setDirty = angular.noop;\n\n\t/**\n\t * To set $touched add a focus listener on the element and all its children\n\t * @function addFocus\n\t * @param {DOM} element\n\t */\n\tfunction addFocus(element) {\n\t\telement = angular.element(element);\n\t\tlet children = element.children();\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\taddFocus(children[i]);\n\t\t}\n\t\telement.on('focus', setTouched);\n\t}\n\n\taddFocus(element);\n\n\t/**\n\t * Set the ngModel $touched value\n\t * @function setTouched\n\t */\n\tfunction setTouched() {\n\t\tNgModelController.$setTouched();\n\t}\n\n\t/**\n\t * Returns the maximum date limit the datepicker can handle\n\t * @function getMaximumLimit\n\t * @returns {moment}\n\t */\n\tfunction getMaximumLimit() {\n\t\tif (!config.max || !moment(config.max).isValid() || !moment(config.max, 'Y-MM-DD', config.strict).isValid()) {\n\t\t\treturn moment().endOf('y').add(200, 'y');\n\t\t}\n\t\treturn isString(config.max) ? moment(config.max, 'Y-MM-DD', true) : moment(config.max);\n\t}\n\n\t/**\n\t * Returns the minimum date limit the datepicker can handle\n\t * @function getMinimumLimit\n\t * @returns {moment}\n\t */\n\tfunction getMinimumLimit() {\n\t\tif (!config.min || !moment(config.min).isValid() || !moment(config.min, 'Y-MM-DD', config.strict).isValid()) {\n\t\t\treturn moment().startOf('y').subtract(200, 'y');\n\t\t}\n\t\treturn isString(config.min) ? moment(config.min, 'Y-MM-DD', true) : moment(config.min);\n\t}\n\n\t/**\n\t * Populates a list of years, i.e. all the years from 100 years from now.\n\t * @function populateYearList\n\t * @name linkFn~populateYearList\n\t */\n\tfunction populateYearList() {\n\n\t\tlet minYear, maxYear;\n\t\tminYear = getMinimumLimit().year();\n\t\tmaxYear = getMaximumLimit().year();\n\t\t$scope.years.splice(0);\n\t\tfor (let i = minYear; i <= maxYear; i++) {\n\t\t\t$scope.years.push(i);\n\t\t}\n\t}\n\n\t/*\n\t * Add validators to the NgModelController\n\t */\n\tangular.extend(NgModelController.$validators, {\n\t\tinvalidDate: isValidatDate,\n\t\trequired: isDateProvided\n\t});\n\n\t/**\n\t * NgModelController validator to check if a valid date has been provided/entered\n\t * @param {string} modelValue\n\t * @param {object} viewValue\n\t * @returns {boolean}\n\t */\n\tfunction isValidatDate(modelValue, viewValue) {\n\t\tif (!config.validate || (!modelValue && !viewValue.year && !viewValue.month && !viewValue.day)) {\n\t\t\treturn true;\n\t\t}\n\t\tlet date = moment(modelValue || (viewValue.year + '-' + viewValue.month + '-' + viewValue.day), 'Y-MM-DD', config.strict);\n\t\treturn date.isValid()\n\t\t\t\t&& date.isSameOrAfter(getMinimumLimit())\n\t\t\t\t&& date.isSameOrBefore(getMaximumLimit());\n\n\t}\n\n\t/**\n\t * NgModelController validator to check if a date has been provided/entered\n\t * @param {string} modelValue\n\t * @param {Object} viewValue\n\t * @returns {boolean}\n\t */\n\tfunction isDateProvided(modelValue, viewValue) {\n\t\t// Check if required attrs is present\n\t\t// If the model value and view value both are empty, only then short-cicrcuit the validation\n\t\treturn attrs.required ? (!!modelValue || !!viewValue.year || !!viewValue.month || !!viewValue.day) : true;\n\t}\n\n\t// Format backend value to the values suitable for view\n\tNgModelController.$formatters.push((modelValue) => {\n\t\tif (modelValue) {\n\t\t\tlet passedDate = moment(modelValue, 'Y-MM-DD');\n\t\t\tlet day = passedDate.format('DD');\n\t\t\tlet month = passedDate.format('MM');\n\t\t\tlet year = passedDate.year();\n\t\t\treturn {day, month, year};\n\t\t} else {\n\t\t\treturn {day: '', month: '', year: null}; //year has data type: number\n\t\t}\n\t});\n\n\t// Format view value to the value suitable for backend\n\tNgModelController.$parsers.push((viewValue) => {\n\t\tif (config.validate && (!viewValue.year || !viewValue.month || !viewValue.day)) {\n\t\t\treturn null;\n\t\t}\n\t\treturn viewValue.year + '-' + viewValue.month + '-' + viewValue.day;\n\t});\n\n\t// Update $scope values from viewValues\n\tNgModelController.$render = () => {\n\t\tif (NgModelController.$viewValue) {\n\t\t\t$scope.day = NgModelController.$viewValue.day;\n\t\t\t$scope.month = NgModelController.$viewValue.month;\n\t\t\t$scope.year = NgModelController.$viewValue.year;\n\t\t}\n\t};\n\n\t// Run digest cycle when a view value changes\n\t$scope.$watch('day + month + year', () => {\n\t\tNgModelController.$setViewValue({\n\t\t\tday: $scope.day,\n\t\t\tmonth: $scope.month,\n\t\t\tyear: $scope.year\n\t\t});\n\t\tNgModelController.$setDirty = tmp;\n\t});\n\n\t// Watch for any configuration updates\n\t$scope.$watch('config', () => {\n\t\tconfig = Object.assign(config, $scope.config);\n\t\tpopulateYearList();\n\t});\n\n}\n\nexport default datepickerComponent;","'use strict';\n\nimport angular from 'angular';\nimport datepickerComponent from './datepicker';\n\nlet dependencies = [];\n\nexport default angular.module('gridle.datepicker', dependencies)\n\t\t.directive('datepicker', datepickerComponent)\n\t\t.name;"],"names":["linkFn","$scope","element","attrs","NgModelController","config","max","min","strict","validate","years","tmp","$setDirty","setTouched","$setTouched","getMaximumLimit","moment","isValid","isString","endOf","add","getMinimumLimit","startOf","subtract","angular","noop","addFocus","children","i","length","on","extend","$validators","invalidDate","modelValue","viewValue","year","month","day","date","isSameOrAfter","isSameOrBefore","required","$formatters","push","passedDate","format","$parsers","$render","$viewValue","$watch","$setViewValue","Object","assign","minYear","maxYear","splice","populateYearList","module","directive","require","restrict","scope","ngModel","template","link","name"],"mappings":"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"}