{"version":3,"file":"timepicker.bundle.js","sources":["../src/timepicker/timepicker.js","../src/timepicker/index.js"],"sourcesContent":["'use strict';\n\nimport angular from 'angular';\nimport moment from 'moment';\n\n/**\n * @memberOf module:\"gridle.timepicker\"\n * @kind function\n * @name timepicker\n *\n * @description\n * The timepicker component renders a custom timepicker. The timepicker provides\n * 3 dropdowns, one for Year, Month and Date. The timepicker also uses the NgModelController,\n * to use the parent ng-model variable and to enable form validations if used within a form.\n *\n * @param {Object} ngModel The ng-model value attached to the element.\n * @param {Object} datetimePickerConfig The datepicker configuration\n * @param {boolean} [datetimePickerConfig.isUtc=true] Whether the dateTime provided is in UTC or not\n * @param {Date|string|moment} [datetimePickerConfig.max=null] The maximum dateTime the datepicker should allow\n * @param {Date|string|moment} [datetimePickerConfig.min=null] The minimum dateTime the datepicker should allow\n * @param {boolean} [datetimePickerConfig.strict=true] Whether a strict parsing should be done or not\n */\n\nfunction timepickerComponent() {\n\n\t/**\n\t * The directives definition\n\t */\n\treturn {\n\t\trequire: 'ngModel',\n\t\trestrict: 'AE',\n\t\tscope: {\n\t\t\tngModel: '=',\n\t\t\tconfig: '<?timepickerConfig',\n\t\t},\n\t\ttemplate: `\n\t\t<div class=\"timepicker-select\" layout=\"row\" layout-align=\"start center\">\n\t\t<select class=\"form-control day\" name=\"HH\" ng-model=\"hour\">\n\t\t\t<option selected=\"\" disabled=\"\" label=\"HH\" value=\"\">HH</option>\n\t\t\t<option value=\"01\">01</option>\n\t\t\t<option value=\"02\">02</option>\n\t\t\t<option value=\"03\">03</option>\n\t\t\t<option value=\"04\">04</option>\n\t\t\t<option value=\"05\">05</option>\n\t\t\t<option value=\"06\">06</option>\n\t\t\t<option value=\"07\">07</option>\n\t\t\t<option value=\"08\">08</option>\n\t\t\t<option value=\"09\">09</option>\n\t\t\t<option value=\"10\">10</option>\n\t\t\t<option value=\"11\">11</option>\n\t\t\t<option value=\"12\">12</option>\n\t\t</select>\n\n\t\t<select class=\"form-control day\" name=\"MM\" ng-model=\"minute\">\n\t\t\t<option selected=\"\" disabled=\"\" label=\"MM\" value=\"\">MM</option>\n\t\t\t\t<option value=\"00\">00</option><option value=\"01\">01</option><option value=\"02\">02</option><option value=\"03\">03</option><option value=\"04\">04</option><option value=\"05\">05</option><option value=\"06\">06</option><option value=\"07\">07</option><option value=\"08\">08</option><option value=\"09\">09</option><option value=\"10\">10</option><option value=\"11\">11</option><option value=\"12\">12</option><option value=\"13\">13</option><option value=\"14\">14</option><option value=\"15\">15</option><option value=\"16\">16</option><option value=\"17\">17</option><option value=\"18\">18</option><option value=\"19\">19</option><option value=\"20\">20</option><option value=\"21\">21</option><option value=\"22\">22</option><option value=\"23\">23</option><option value=\"24\">24</option><option value=\"25\">25</option><option value=\"26\">26</option><option value=\"27\">27</option><option value=\"28\">28</option><option value=\"29\">29</option><option value=\"30\">30</option><option value=\"31\">31</option><option value=\"32\">32</option><option value=\"33\">33</option><option value=\"34\">34</option><option value=\"35\">35</option><option value=\"36\">36</option><option value=\"37\">37</option><option value=\"38\">38</option><option value=\"39\">39</option><option value=\"40\">40</option><option value=\"41\">41</option><option value=\"42\">42</option><option value=\"43\">43</option><option value=\"44\">44</option><option value=\"45\">45</option><option value=\"46\">46</option><option value=\"47\">47</option><option value=\"48\">48</option><option value=\"49\">49</option><option value=\"50\">50</option><option value=\"51\">51</option><option value=\"52\">52</option><option value=\"53\">53</option><option value=\"54\">54</option><option value=\"55\">55</option><option value=\"56\">56</option><option value=\"57\">57</option><option value=\"58\">58</option><option value=\"59\">59</option>\n\t\t\t</select>\n\n\t\t\t<select class=\"form-control day\" name=\"meridian\" ng-model=\"meridian\">\n\t\t\t\t<option selected=\"\" label=\"AM\" value=\"AM\">AM</option>\n\t\t\t\t<option value=\"PM\">PM</option>\n\t\t\t</select>\n\t</div>\n\t\t`,\n\t\tlink: linkFn\n\t};\n}\n\n/**\n * The date-picker components link function\n * @function linkFn\n * @name timepickerComponent#link\n * @kind link\n */\nfunction linkFn($scope, element, attrs, NgModelController) {\n\n\t/**\n\t * The datepicker configuration object\n\t * @property {Date|string|moment} [max=null] The maximum date the datepicker should allow\n\t * @property {Date|string|moment} [min=null] The minimum date the datepicker should allow\n\t * @property {boolean} [strict=true] Whether a strict parsing should be done or not\n\t * @property {boolean} [validate=false] Whether to perform validation on the value or not\n\t * @type {Object}\n\t */\n\tlet config = {\n\t\tstrict: true,\n\t\tvalidate: true\n\t};\n\n\t/**\n\t * The time meridian\n\t * @type {string}\n\t */\n\t$scope.meridian = 'AM';\n\n\t/**\n\t * Stores the reference to the $setDirty method of the NgModelController.\n\t * @type {NgModel.$setDirty}\n\t */\n\tlet tmp = NgModelController.$setDirty;\n\n\t// Temporarily set the $setDirty function to noop, to make sure form-validations work properly\n\tNgModelController.$setDirty = angular.noop;\n\n\t/**\n\t * To set $touched add a focus listener on the element and all its children\n\t * @function addFocus\n\t * @param {DOM} element\n\t */\n\tfunction addFocus(element) {\n\t\telement = angular.element(element);\n\t\tlet children = element.children();\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\taddFocus(children[i]);\n\t\t}\n\t\telement.on('focus', setTouched);\n\t}\n\n\taddFocus(element);\n\n\t/**\n\t * Set the ngModel $touched value\n\t * @function setTouched\n\t */\n\tfunction setTouched() {\n\t\tNgModelController.$setTouched();\n\t}\n\n\t/*\n\t * Add validators to the NgModelController\n\t */\n\tangular.extend(NgModelController.$validators, {\n\t\trequired: isTimeProvided\n\t});\n\n\t/**\n\t * NgModelController validator to check if a time has been provided/entered\n\t * @function isTimeProvided\n\t * @param {string} modelValue\n\t * @param {object} viewValue\n\t * @returns {boolean}\n\t */\n\tfunction isTimeProvided(modelValue, viewValue) {\n\t\t// Check if required attrs is present\n\t\t// If it is present, check the model value, else short-circuit and return true, to bypass the validation\n\t\treturn attrs.required ? !!modelValue : true;\n\t}\n\n\t// Format backend value to the values suitable for view\n\tNgModelController.$formatters.push((modelValue) => {\n\t\tif (!modelValue) {\n\t\t\treturn {hour: '', minute: '', meridian: 'AM'};\n\t\t}\n\t\tlet time = moment(modelValue, 'HH:mm:00', config.strict);\n\t\treturn {\n\t\t\thour: time.format('hh'),\n\t\t\tminute: time.format('mm'),\n\t\t\tmeridian: time.format('A')\n\t\t};\n\t});\n\n\t// Format view value to the value suitable for backend\n\tNgModelController.$parsers.push((viewValue) => {\n\t\tif (config.validate && (!viewValue.hour || !viewValue.minute)) {\n\t\t\treturn null;\n\t\t}\n\t\tlet hour = viewValue.hour;\n\t\tlet min = viewValue.minute;\n\t\tlet meridian = viewValue.meridian;\n\t\tlet value = hour + ':' + min + ' ' + meridian;\n\t\treturn moment(value, 'hh:mm A', config.strict).format('HH:mm:00');\n\t});\n\n\t// Update $scope values from viewValues\n\tNgModelController.$render = () => {\n\t\tif (NgModelController.$viewValue) {\n\t\t\t$scope.hour = NgModelController.$viewValue.hour;\n\t\t\t$scope.minute = NgModelController.$viewValue.minute;\n\t\t\t$scope.meridian = NgModelController.$viewValue.meridian;\n\t\t}\n\t};\n\n\t// Run digest cycle when a view value changes\n\t$scope.$watch('hour + minute + meridian', function () {\n\t\tNgModelController.$setViewValue({\n\t\t\thour: $scope.hour,\n\t\t\tminute: $scope.minute,\n\t\t\tmeridian: $scope.meridian\n\t\t});\n\t\tNgModelController.$setDirty = tmp;\n\t});\n\n\t// Watch for any configuration updates\n\t$scope.$watch('config', () => {\n\t\tconfig = Object.assign(config, $scope.config);\n\t});\n\n}\n\nexport default timepickerComponent;","'use strict';\n\nimport angular from 'angular';\nimport timepickerComponent from './timepicker';\n\nlet dependencies = [];\n\nexport default angular.module('gridle.timepicker', dependencies)\n\t\t.directive('timepicker', timepickerComponent)\n\t\t.name;"],"names":["linkFn","$scope","element","attrs","NgModelController","config","strict","validate","meridian","tmp","$setDirty","setTouched","$setTouched","angular","noop","addFocus","children","i","length","on","extend","$validators","required","modelValue","viewValue","$formatters","push","hour","minute","time","moment","format","$parsers","min","$render","$viewValue","$watch","$setViewValue","Object","assign","module","directive","require","restrict","scope","ngModel","template","link","name"],"mappings":"oQA0EA,SAASA,EAAOC,EAAQC,EAASC,EAAOC,GAUvC,IAAIC,GACHC,QAAQ,EACRC,UAAU,GAOXN,EAAOO,SAAW,KAMlB,IAAIC,EAAML,EAAkBM,UAyB5B,SAASC,IACRP,EAAkBQ,cAvBnBR,EAAkBM,UAAYG,EAAQC,KAOtC,SAASC,EAASb,GAEjB,IAAIc,GADJd,EAAUW,EAAQX,QAAQA,IACHc,WACvB,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAASE,OAAQD,IACpCF,EAASC,EAASC,IAEnBf,EAAQiB,GAAG,QAASR,GAGrBI,CAASb,GAaTW,EAAQO,OAAOhB,EAAkBiB,aAChCC,SAUD,SAAwBC,EAAYC,GAGnC,OAAOrB,EAAMmB,YAAaC,KAI3BnB,EAAkBqB,YAAYC,KAAMH,IACnC,IAAKA,EACJ,OAAQI,KAAM,GAAIC,OAAQ,GAAIpB,SAAU,MAEzC,IAAIqB,EAAOC,EAAOP,EAAY,WAAYlB,EAAOC,QACjD,OACCqB,KAAME,EAAKE,OAAO,MAClBH,OAAQC,EAAKE,OAAO,MACpBvB,SAAUqB,EAAKE,OAAO,QAKxB3B,EAAkB4B,SAASN,KAAMF,IAChC,GAAInB,EAAOE,YAAciB,EAAUG,OAASH,EAAUI,QACrD,OAAO,KAER,IAAID,EAAOH,EAAUG,KACjBM,EAAMT,EAAUI,OAChBpB,EAAWgB,EAAUhB,SAEzB,OAAOsB,EADKH,EAAO,IAAMM,EAAM,IAAMzB,EAChB,UAAWH,EAAOC,QAAQyB,OAAO,cAIvD3B,EAAkB8B,QAAU,MACvB9B,EAAkB+B,aACrBlC,EAAO0B,KAAOvB,EAAkB+B,WAAWR,KAC3C1B,EAAO2B,OAASxB,EAAkB+B,WAAWP,OAC7C3B,EAAOO,SAAWJ,EAAkB+B,WAAW3B,YAKjDP,EAAOmC,OAAO,2BAA4B,WACzChC,EAAkBiC,eACjBV,KAAM1B,EAAO0B,KACbC,OAAQ3B,EAAO2B,OACfpB,SAAUP,EAAOO,WAElBJ,EAAkBM,UAAYD,IAI/BR,EAAOmC,OAAO,SAAU,KACvB/B,EAASiC,OAAOC,OAAOlC,EAAQJ,EAAOI,2GC3LzBQ,EAAQ2B,OAAO,wBAC3BC,UAAU,aDeb,WAKC,OACCC,QAAS,UACTC,SAAU,KACVC,OACCC,QAAS,IACTxC,OAAQ,sBAETyC,SAAU,szFA6BVC,KAAM/C,KCvDLgD"}